# GitHub Actions Workflow: å‘å¸ƒç¬”è®°åˆ° Telegram Channel

name: Publish Note to Telegram

on:
  issues:
    types: [labeled]

jobs:
  publish-to-telegram:
    if: github.event.label.name == 'publish'
    runs-on: ubuntu-latest
    steps:
      - name: Get Issue Details
        id: issue-details
        uses: actions/github-script@v7
        with:
          script: |
            const issue = context.payload.issue;
            const labels = issue.labels.map(l => l.name).join(', ');
            const body = issue.body || '';
            
            // æå–æ ‡é¢˜å’Œå†…å®¹
            const title = issue.title;
            const content = body;
            
            // æ„å»ºå‘é€åˆ° Telegram çš„æ¶ˆæ¯
            const message = `ğŸ“ *${title}*\n\n${content}\n\n---\nğŸ·ï¸ æ ‡ç­¾: ${labels}`;
            
            // è®¾ç½®è¾“å‡º
            return { title, content, message, labels };

      - name: Send to Telegram Channel
        uses: appleboy/telegram-action@v1
        with:
          to: ${{ secrets.TG_CHAT_ID }}
          token: ${{ secrets.TG_BOT_TOKEN }}
          message: ${{ steps.issue-details.outputs.message }}
          format: markdown

      - name: Add Comment to Issue
        uses: actions/github-script@v7
        with:
          script: |
            github.rest.issues.createComment({
              issue_number: context.issue.number,
              owner: context.repo.owner,
              repo: context.repo.repo,
              body: 'âœ… å·²å‘é€åˆ° Telegram Channelï¼Œåšå®¢å°†è‡ªåŠ¨åŒæ­¥æ›´æ–°ï¼'
            })
